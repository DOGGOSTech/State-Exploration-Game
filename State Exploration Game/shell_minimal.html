<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>State Explorer Terminal</title>
    <style>
        body { background: #111; color: #0f0; font-family: monospace; display: flex; justify-content: center; padding: 20px; }
        #output {
            width: 800px; height: 500px;
            background: #000; border: 2px solid #0f0;
            padding: 15px; overflow-y: auto; white-space: pre-wrap;
            box-shadow: 0 0 20px #0f0;
        }
        #input-container { display: flex; width: 800px; margin-top: 10px; }
        #prompt { color: #0f0; margin-right: 5px; }
        #input { background: #000; color: #0f0; border: none; outline: none; flex-grow: 1; font-family: inherit; }
    </style>
</head>
<body>
    <div style="display: flex; flex-direction: column; align-items: center;">
        <div id="output"></div>
        <div id="input-container">
            <span id="prompt">></span>
            <input type="text" id="input" autofocus autocomplete="off">
        </div>
    </div>

    <script type='text/javascript'>
        var statusElement = document.getElementById('status');
        var outputElement = document.getElementById('output');
        var inputElement = document.getElementById('input');

        var Module = {
            preRun: [],
            postRun: [],
            print: function(text) {
                if (arguments.length > 1) text = Array.prototype.slice.call(arguments).join(' ');
                outputElement.innerText += text + "\n";
                outputElement.scrollTop = outputElement.scrollHeight;
            },
            canvas: (function() { return null; })(), // Not needed for text games
            setStatus: function(text) { console.log(text); },
        };

        inputElement.addEventListener('keydown', function(event) {
            if (event.keyCode === 13) { // Enter key
                const val = inputElement.value;
                Module.print("> " + val); // Echo input to screen
                // This sends the string to the C++ cin buffer
                handler(val + "\n");
                inputElement.value = "";
            }
        });

        // This connects the browser input to the C++ cin
        var stdin_buffer = [];
        function handler(text) {
            for(var i=0; i<text.length; i++) {
                stdin_buffer.push(text.charCodeAt(i));
            }
        }

        Module['stdin'] = function() {
            if (stdin_buffer.length > 0) {
                return stdin_buffer.shift();
            }
            return null;
        };
    </script>
    {{{ SCRIPT }}}
</body>
</html>